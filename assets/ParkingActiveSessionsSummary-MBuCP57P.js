import{aE as h,az as P,r as v,aA as x,ao as o,a as j,aF as S,j as s,aB as A}from"./iframe-6v42livS.js";import{P as _}from"./Pressable-CxmNzNJT.js";import{B as k}from"./Badge-DBX1nXLt.js";import{P as B}from"./PleaseWait-A77XLKCb.js";import{S as D}from"./SomethingWentWrong-Rbrlu4PW.js";import{C as I}from"./Column-Cpxx55qu.js";import{R}from"./Row-BfAXyDYM.js";import{P as T}from"./Phrase-CMoYPP0G.js";import{T as c}from"./Title-C5p9lqQg.js";import{u as W}from"./useNavigation-CmVF1fdu.js";import{u as b}from"./useBoolean-CfUHnVYX.js";import{u as E,a as N,b as y}from"./useGetParkingSessions-CycCBa4A.js";import{P as z}from"./ParkingSessionNavigationButton-DWCaRpiO.js";const U=()=>{const{navigate:f}=W(),{parkingSessions:e,isLoading:u,isError:g,refetch:r}=E(h.active),i=P(),{value:n,enable:m}=b(!1);v.useEffect(()=>{(i==null?void 0:i.scope)!==x.visitor&&!n&&e!=null&&e.some(t=>!t.ps_right_id)&&(r(),m())},[e,n,i==null?void 0:i.scope,r,m]),N(r,e!=null&&e.some(t=>"is_paid"in t&&!t.is_paid)?5e3:0);const a=e!=null&&e.length?e.reduce((t,d)=>{const l=o(d.end_date_time);return l.isAfter(t)?t:l},o(e[0].end_date_time)):void 0,p=j();return y(()=>{p(S.util.invalidateTags(["ParkingSessions"]))},e!=null&&e.length?Math.max((a==null?void 0:a.endOf("minute").diff(o(),"milliseconds"))??0,3e4):0),u?s.jsx(B,{testID:"ParkingPermitSessionsActivePleaseWait"}):g?s.jsx(D,{testID:"ParkingActiveSessionsSummarySomethingWentWrong"}):!e||e.length<=5?s.jsxs(I,{gutter:"sm",children:[s.jsx(c,{level:"h5",testID:"ParkingPermitSessionsActiveTitle",text:"Nu actief"}),e!=null&&e.length?e.map(t=>s.jsx(z,{parkingSession:t},t.ps_right_id??t.vehicle_id)):s.jsx(T,{testID:"ParkingPermitSessionsActiveNotActivePhrase",children:"Er zijn geen actieve parkeersessies."})]}):s.jsx(_,{accessibilityLabel:`${e.length} actieve parkeersessies`,onPress:()=>f(A.parkingActiveSessions),testID:"ParkingPermitSessionsActiveBadgeButton",children:s.jsxs(R,{gutter:"sm",children:[s.jsx(c,{color:"link",level:"h5",testID:"ParkingPermitSessionsActiveTitle",text:"Actief"}),s.jsx(k,{color:"info",testID:"ParkingPermitSessionsActiveBadge",value:e.length})]})})};export{U as P};
