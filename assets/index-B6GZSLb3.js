import{r as c}from"./index-B-xgG2PE.js";var g="DELAY",_="ERROR",d="LONG_PRESS_DETECTED",l="NOT_RESPONDER",R="RESPONDER_ACTIVE_LONG_PRESS_START",T="RESPONDER_ACTIVE_PRESS_START",D="RESPONDER_INACTIVE_PRESS_START",b="RESPONDER_GRANT",P="RESPONDER_RELEASE",L="RESPONDER_TERMINATED",p=Object.freeze({NOT_RESPONDER:{DELAY:_,RESPONDER_GRANT:D,RESPONDER_RELEASE:_,RESPONDER_TERMINATED:_,LONG_PRESS_DETECTED:_},RESPONDER_INACTIVE_PRESS_START:{DELAY:T,RESPONDER_GRANT:_,RESPONDER_RELEASE:l,RESPONDER_TERMINATED:l,LONG_PRESS_DETECTED:_},RESPONDER_ACTIVE_PRESS_START:{DELAY:_,RESPONDER_GRANT:_,RESPONDER_RELEASE:l,RESPONDER_TERMINATED:l,LONG_PRESS_DETECTED:R},RESPONDER_ACTIVE_LONG_PRESS_START:{DELAY:_,RESPONDER_GRANT:_,RESPONDER_RELEASE:l,RESPONDER_TERMINATED:l,LONG_PRESS_DETECTED:R},ERROR:{DELAY:l,RESPONDER_GRANT:D,RESPONDER_RELEASE:l,RESPONDER_TERMINATED:l,LONG_PRESS_DETECTED:l}}),y=r=>r.getAttribute("role"),v=r=>r.tagName.toLowerCase(),N=r=>r===T||r===R,S=r=>y(r)==="button",A=r=>r===D||r===T||r===R,I=r=>r===L||r===P,O=r=>{var t=r.key,a=r.target,i=t===" "||t==="Spacebar",e=v(a)==="button"||S(a);return t==="Enter"||i&&e},G=450,M=50;class Y{constructor(t){this._eventHandlers=null,this._isPointerTouch=!1,this._longPressDelayTimeout=null,this._longPressDispatched=!1,this._pressDelayTimeout=null,this._pressOutDelayTimeout=null,this._touchState=l,this._responderElement=null,this.configure(t)}configure(t){this._config=t}reset(){this._cancelLongPressDelayTimeout(),this._cancelPressDelayTimeout(),this._cancelPressOutDelayTimeout()}getEventHandlers(){return this._eventHandlers==null&&(this._eventHandlers=this._createEventHandlers()),this._eventHandlers}_createEventHandlers(){var t=(e,s)=>{e.persist(),this._cancelPressOutDelayTimeout(),this._longPressDispatched=!1,this._selectionTerminated=!1,this._touchState=l,this._isPointerTouch=e.nativeEvent.type==="touchstart",this._receiveSignal(b,e);var n=f(this._config.delayPressStart,0,M);s!==!1&&n>0?this._pressDelayTimeout=setTimeout(()=>{this._receiveSignal(g,e)},n):this._receiveSignal(g,e);var o=f(this._config.delayLongPress,10,G);this._longPressDelayTimeout=setTimeout(()=>{this._handleLongPress(e)},o+n)},a=e=>{this._receiveSignal(P,e)},i=e=>{var s=this._config.onPress,n=e.target;if(this._touchState!==l&&O(e)){a(e),document.removeEventListener("keyup",i);var o=n.getAttribute("role"),E=v(n),u=o==="link"||E==="a"||E==="button"||E==="input"||E==="select"||E==="textarea",h=this._responderElement===n;s!=null&&!u&&h&&s(e),this._responderElement=null}};return{onStartShouldSetResponder:e=>{var s=this._config.disabled;return s&&S(e.currentTarget)&&e.stopPropagation(),s==null?!0:!s},onKeyDown:e=>{var s=this._config.disabled,n=e.key,o=e.target;if(!s&&O(e)){this._touchState===l&&(t(e,!1),this._responderElement=o,document.addEventListener("keyup",i));var E=n===" "||n==="Spacebar",u=y(o),h=u==="button"||u==="menuitem";E&&h&&v(o)!=="button"&&e.preventDefault(),e.stopPropagation()}},onResponderGrant:e=>t(e),onResponderMove:e=>{this._config.onPressMove!=null&&this._config.onPressMove(e);var s=m(e);if(this._touchActivatePosition!=null){var n=this._touchActivatePosition.pageX-s.pageX,o=this._touchActivatePosition.pageY-s.pageY;Math.hypot(n,o)>10&&this._cancelLongPressDelayTimeout()}},onResponderRelease:e=>a(e),onResponderTerminate:e=>{e.nativeEvent.type==="selectionchange"&&(this._selectionTerminated=!0),this._receiveSignal(L,e)},onResponderTerminationRequest:e=>{var s=this._config,n=s.cancelable,o=s.disabled,E=s.onLongPress;return!o&&E!=null&&this._isPointerTouch&&e.nativeEvent.type==="contextmenu"?!1:n??!0},onClick:e=>{var s=this._config,n=s.disabled,o=s.onPress;n?S(e.currentTarget)&&e.stopPropagation():(e.stopPropagation(),this._longPressDispatched||this._selectionTerminated?e.preventDefault():o!=null&&e.altKey===!1&&o(e))},onContextMenu:e=>{var s=this._config,n=s.disabled,o=s.onLongPress;n?S(e.currentTarget)&&e.stopPropagation():o!=null&&this._isPointerTouch&&!e.defaultPrevented&&(e.preventDefault(),e.stopPropagation())}}}_receiveSignal(t,a){var i=this._touchState,e=null;p[i]!=null&&(e=p[i][t]),!(this._touchState===l&&t===P)&&(e==null||e===_?console.error("PressResponder: Invalid signal "+t+" for state "+i+" on responder"):i!==e&&(this._performTransitionSideEffects(i,e,t,a),this._touchState=e))}_performTransitionSideEffects(t,a,i,e){if(I(i)&&(setTimeout(()=>{this._isPointerTouch=!1},0),this._touchActivatePosition=null,this._cancelLongPressDelayTimeout()),A(t)&&i===d){var s=this._config.onLongPress;s!=null&&e.nativeEvent.key==null&&(s(e),this._longPressDispatched=!0)}var n=N(t),o=N(a);if(!n&&o?this._activate(e):n&&!o&&this._deactivate(e),A(t)&&i===P){var E=this._config,u=E.onLongPress,h=E.onPress;if(h!=null){var C=u!=null&&t===R;C||!o&&!n&&(this._activate(e),this._deactivate(e))}}this._cancelPressDelayTimeout()}_activate(t){var a=this._config,i=a.onPressChange,e=a.onPressStart,s=m(t);this._touchActivatePosition={pageX:s.pageX,pageY:s.pageY},e!=null&&e(t),i!=null&&i(!0)}_deactivate(t){var a=this._config,i=a.onPressChange,e=a.onPressEnd;function s(){e!=null&&e(t),i!=null&&i(!1)}var n=f(this._config.delayPressEnd);n>0?this._pressOutDelayTimeout=setTimeout(()=>{s()},n):s()}_handleLongPress(t){(this._touchState===T||this._touchState===R)&&this._receiveSignal(d,t)}_cancelLongPressDelayTimeout(){this._longPressDelayTimeout!=null&&(clearTimeout(this._longPressDelayTimeout),this._longPressDelayTimeout=null)}_cancelPressDelayTimeout(){this._pressDelayTimeout!=null&&(clearTimeout(this._pressDelayTimeout),this._pressDelayTimeout=null)}_cancelPressOutDelayTimeout(){this._pressOutDelayTimeout!=null&&(clearTimeout(this._pressOutDelayTimeout),this._pressOutDelayTimeout=null)}}function f(r,t,a){return t===void 0&&(t=0),a===void 0&&(a=0),Math.max(t,r??a)}function m(r){var t=r.nativeEvent,a=t.changedTouches,i=t.touches;return i!=null&&i.length>0?i[0]:a!=null&&a.length>0?a[0]:r.nativeEvent}function H(r,t){var a=c.useRef(null);a.current==null&&(a.current=new Y(t));var i=a.current;return c.useEffect(()=>{i.configure(t)},[t,i]),c.useEffect(()=>()=>{i.reset()},[i]),c.useDebugValue(t),i.getEventHandlers()}export{H as u};
