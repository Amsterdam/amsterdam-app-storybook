import{bF as B,r as g,bG as C,bH as O,a$ as R,bD as m,bI as V,b6 as K,bJ as N,bB as w,bK as M,bL as H,bM as U,bb as J,bN as f,bc as q,bO as z,bP as G,o as Q,j as s,b9 as Z,C as F,bg as I,e as $,b1 as W,n as X,aH as Y,bQ as ee,g as te}from"./iframe-CHiEOCum.js";import{u as ne}from"./useCurrentParkingApiVersion-8uRgbPtp.js";import"./preload-helper-Dp1pzeXC.js";const re=e=>e===R.permitHolder?C.parkingPermitHolder:C.parkingVisitor,ie=()=>{const e=B();return g.useCallback(async(t,c)=>{const u=re(c);let r=[];try{const i=await O(u);if(i){let o;try{o=JSON.parse(i)}catch{o=[]}Array.isArray(o)&&(r=o.filter(a=>typeof a=="object"&&a!==null&&"reportCode"in a&&"pin"in a))}}catch{r=[]}r=r.filter(i=>i.reportCode!==t.reportCode),r.push(t),await e(u,JSON.stringify(r))},[e])},se=e=>{if(!e)return;const t="data"in e&&e.data&&typeof e.data=="object"&&"code"in e.data&&e.data.code;return t==="SSP_BAD_CREDENTIALS"?m.loginForbiddenFailed:t==="SSP_ACCOUNT_INACTIVE"?m.loginAccountInactiveFailed:t==="SSP_ACCOUNT_BLOCKED"?m.loginAccountBlockedFailed:m.loginFailed},oe=()=>{const e=ne(),t=V(),c=K({defaultValues:t}),u=g.useRef(null),{setAccessToken:r}=N(),{resetAlert:i,setAlert:o}=w(),a=M(),{openRedirect:j}=H(),{handleSubmit:_,setValue:k}=c,[D,{error:P,isError:A,isLoading:S}]=U(),T=ie(),l=J(),x=_(async({pin:n,reportCode:d})=>{try{const{access_token:p,access_token_expiration:v,scope:y}=await D({pin:n,report_code:d}).unwrap();await T({pin:n,reportCode:d},y),r(d,p,v),l(f.actions.setCurrentAccount(d)),l(f.actions.setCurrentPermitReportCode(void 0)),l(f.actions.setParkingAccount({reportCode:d,scope:y})),l(q.util.resetApiState()),l(z(!1))}catch(p){a(G.parkingLoginFailed,"ParkingLoginForm.tsx",{error:p}),Q("ParkingLoginForm onSubmit error:",p)}});return g.useEffect(()=>{t&&(k("reportCode",t.reportCode),k("pin",t.pin))},[t,k]),g.useEffect(()=>{if(!A)return;const n=se(P);n&&o(n)},[A,P,o]),g.useEffect(()=>{S&&i()},[S,i]),s.jsx(Z,{...c,children:s.jsxs(F,{gutter:"xl",children:[s.jsxs(F,{gutter:"md",children:[s.jsx(I,{autoFocus:!0,hasClearButton:!1,keyboardType:e===W.v1?"number-pad":"numbers-and-punctuation",label:"Meldcode",name:"reportCode",onSubmitEditing:()=>{var n;(n=u.current)==null||n.focus()},returnKeyType:$.OS==="android"?"done":void 0,rules:{required:"Vul een meldcode in"},submitBehavior:"submit",testID:"ParkingLoginFormReportCodeInputField",textTransform:n=>n.replaceAll(/[^a-zA-Z0-9]/g,"").toUpperCase()}),s.jsx(I,{hasClearButton:!1,keyboardType:"number-pad",label:"Pincode",name:"pin",onSubmitEditing:x,ref:u,rules:{required:"Vul een pincode in"},testID:"ParkingLoginFormPinCodeInputField"}),s.jsxs(X,{children:["Meld- of pincode kwijt? U vindt ze in"," ",s.jsx(Y,{isExternal:!0,"logging-label":"ParkingLoginFormInlineLink",onPress:()=>j(ee.my_parking),testID:"ParkingLoginFormInlineLink",children:"Mijn Parkeren"})]})]}),s.jsx(te,{isLoading:c.formState.isSubmitting,label:"Inloggen",onPress:x,testID:"ParkingLoginFormSubmitButton"})]})})},le={component:oe},b={};var L,E,h;b.parameters={...b.parameters,docs:{...(L=b.parameters)==null?void 0:L.docs,source:{originalSource:"{}",...(h=(E=b.parameters)==null?void 0:E.docs)==null?void 0:h.source}}};const de=["Default"];export{b as Default,de as __namedExportsOrder,le as default};
