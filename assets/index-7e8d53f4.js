import{r as c}from"./index-4ab02870.js";var v="DELAY",_="ERROR",d="LONG_PRESS_DETECTED",E="NOT_RESPONDER",R="RESPONDER_ACTIVE_LONG_PRESS_START",S="RESPONDER_ACTIVE_PRESS_START",D="RESPONDER_INACTIVE_PRESS_START",b="RESPONDER_GRANT",h="RESPONDER_RELEASE",L="RESPONDER_TERMINATED",N=Object.freeze({NOT_RESPONDER:{DELAY:_,RESPONDER_GRANT:D,RESPONDER_RELEASE:_,RESPONDER_TERMINATED:_,LONG_PRESS_DETECTED:_},RESPONDER_INACTIVE_PRESS_START:{DELAY:S,RESPONDER_GRANT:_,RESPONDER_RELEASE:E,RESPONDER_TERMINATED:E,LONG_PRESS_DETECTED:_},RESPONDER_ACTIVE_PRESS_START:{DELAY:_,RESPONDER_GRANT:_,RESPONDER_RELEASE:E,RESPONDER_TERMINATED:E,LONG_PRESS_DETECTED:R},RESPONDER_ACTIVE_LONG_PRESS_START:{DELAY:_,RESPONDER_GRANT:_,RESPONDER_RELEASE:E,RESPONDER_TERMINATED:E,LONG_PRESS_DETECTED:R},ERROR:{DELAY:E,RESPONDER_GRANT:D,RESPONDER_RELEASE:E,RESPONDER_TERMINATED:E,LONG_PRESS_DETECTED:E}}),y=r=>r.getAttribute("role"),g=r=>r.tagName.toLowerCase(),p=r=>r===S||r===R,P=r=>y(r)==="button",A=r=>r===D||r===S||r===R,I=r=>r===L||r===h,O=r=>{var t=r.key,a=r.target,i=t===" "||t==="Spacebar",e=g(a)==="button"||P(a);return t==="Enter"||i&&e},G=450,M=50;class Y{constructor(t){this._eventHandlers=null,this._isPointerTouch=!1,this._longPressDelayTimeout=null,this._longPressDispatched=!1,this._pressDelayTimeout=null,this._pressOutDelayTimeout=null,this._touchState=E,this.configure(t)}configure(t){this._config=t}reset(){this._cancelLongPressDelayTimeout(),this._cancelPressDelayTimeout(),this._cancelPressOutDelayTimeout()}getEventHandlers(){return this._eventHandlers==null&&(this._eventHandlers=this._createEventHandlers()),this._eventHandlers}_createEventHandlers(){var t=(e,s)=>{e.persist(),this._cancelPressOutDelayTimeout(),this._longPressDispatched=!1,this._selectionTerminated=!1,this._touchState=E,this._isPointerTouch=e.nativeEvent.type==="touchstart",this._receiveSignal(b,e);var n=f(this._config.delayPressStart,0,M);s!==!1&&n>0?this._pressDelayTimeout=setTimeout(()=>{this._receiveSignal(v,e)},n):this._receiveSignal(v,e);var o=f(this._config.delayLongPress,10,G);this._longPressDelayTimeout=setTimeout(()=>{this._handleLongPress(e)},o+n)},a=e=>{this._receiveSignal(h,e)},i=e=>{var s=this._config.onPress,n=e.target;if(this._touchState!==E&&O(e)){a(e),document.removeEventListener("keyup",i);var o=n.getAttribute("role"),l=g(n),u=o==="link"||l==="a"||l==="button"||l==="input"||l==="select"||l==="textarea";s!=null&&!u&&s(e)}};return{onStartShouldSetResponder:e=>{var s=this._config.disabled;return s&&P(e.currentTarget)&&e.stopPropagation(),s==null?!0:!s},onKeyDown:e=>{var s=this._config.disabled,n=e.key,o=e.target;if(!s&&O(e)){this._touchState===E&&(t(e,!1),document.addEventListener("keyup",i));var l=n===" "||n==="Spacebar",u=y(o),T=u==="button"||u==="menuitem";l&&T&&g(o)!=="button"&&e.preventDefault(),e.stopPropagation()}},onResponderGrant:e=>t(e),onResponderMove:e=>{this._config.onPressMove!=null&&this._config.onPressMove(e);var s=m(e);if(this._touchActivatePosition!=null){var n=this._touchActivatePosition.pageX-s.pageX,o=this._touchActivatePosition.pageY-s.pageY;Math.hypot(n,o)>10&&this._cancelLongPressDelayTimeout()}},onResponderRelease:e=>a(e),onResponderTerminate:e=>{e.nativeEvent.type==="selectionchange"&&(this._selectionTerminated=!0),this._receiveSignal(L,e)},onResponderTerminationRequest:e=>{var s=this._config,n=s.cancelable,o=s.disabled,l=s.onLongPress;return!o&&l!=null&&this._isPointerTouch&&e.nativeEvent.type==="contextmenu"?!1:n??!0},onClick:e=>{var s=this._config,n=s.disabled,o=s.onPress;n?P(e.currentTarget)&&e.stopPropagation():(e.stopPropagation(),this._longPressDispatched||this._selectionTerminated?e.preventDefault():o!=null&&e.altKey===!1&&o(e))},onContextMenu:e=>{var s=this._config,n=s.disabled,o=s.onLongPress;n?P(e.currentTarget)&&e.stopPropagation():o!=null&&this._isPointerTouch&&!e.defaultPrevented&&(e.preventDefault(),e.stopPropagation())}}}_receiveSignal(t,a){var i=this._touchState,e=null;N[i]!=null&&(e=N[i][t]),!(this._touchState===E&&t===h)&&(e==null||e===_?console.error("PressResponder: Invalid signal "+t+" for state "+i+" on responder"):i!==e&&(this._performTransitionSideEffects(i,e,t,a),this._touchState=e))}_performTransitionSideEffects(t,a,i,e){if(I(i)&&(setTimeout(()=>{this._isPointerTouch=!1},0),this._touchActivatePosition=null,this._cancelLongPressDelayTimeout()),A(t)&&i===d){var s=this._config.onLongPress;s!=null&&e.nativeEvent.key==null&&(s(e),this._longPressDispatched=!0)}var n=p(t),o=p(a);if(!n&&o?this._activate(e):n&&!o&&this._deactivate(e),A(t)&&i===h){var l=this._config,u=l.onLongPress,T=l.onPress;if(T!=null){var C=u!=null&&t===R;C||!o&&!n&&(this._activate(e),this._deactivate(e))}}this._cancelPressDelayTimeout()}_activate(t){var a=this._config,i=a.onPressChange,e=a.onPressStart,s=m(t);this._touchActivatePosition={pageX:s.pageX,pageY:s.pageY},e!=null&&e(t),i!=null&&i(!0)}_deactivate(t){var a=this._config,i=a.onPressChange,e=a.onPressEnd;function s(){e!=null&&e(t),i!=null&&i(!1)}var n=f(this._config.delayPressEnd);n>0?this._pressOutDelayTimeout=setTimeout(()=>{s()},n):s()}_handleLongPress(t){(this._touchState===S||this._touchState===R)&&this._receiveSignal(d,t)}_cancelLongPressDelayTimeout(){this._longPressDelayTimeout!=null&&(clearTimeout(this._longPressDelayTimeout),this._longPressDelayTimeout=null)}_cancelPressDelayTimeout(){this._pressDelayTimeout!=null&&(clearTimeout(this._pressDelayTimeout),this._pressDelayTimeout=null)}_cancelPressOutDelayTimeout(){this._pressOutDelayTimeout!=null&&(clearTimeout(this._pressOutDelayTimeout),this._pressOutDelayTimeout=null)}}function f(r,t,a){return t===void 0&&(t=0),a===void 0&&(a=0),Math.max(t,r??a)}function m(r){var t=r.nativeEvent,a=t.changedTouches,i=t.touches;return i!=null&&i.length>0?i[0]:a!=null&&a.length>0?a[0]:r.nativeEvent}function H(r,t){var a=c.useRef(null);a.current==null&&(a.current=new Y(t));var i=a.current;return c.useEffect(()=>{i.configure(t)},[t,i]),c.useEffect(()=>()=>{i.reset()},[i]),c.useDebugValue(t),i.getEventHandlers()}export{H as u};
//# sourceMappingURL=index-7e8d53f4.js.map
