import{j as i}from"./jsx-runtime-DNHyKP0h.js";import{r as h}from"./index-B-xgG2PE.js";import{P as v}from"./Pressable-BmZw1ve9.js";import{B as x}from"./Badge-VDpfJBo-.js";import{P as j}from"./PleaseWait-D5U0C8mk.js";import{S}from"./SomethingWentWrong-JoEozYXT.js";import{C as A}from"./Column-BCfAP6c3.js";import{R as _}from"./Row-T-kBD67c.js";import{P as k}from"./Phrase-C3Pw4gWB.js";import{T as p}from"./Title-BvOtsuWi.js";import{u as D}from"./useNavigation-BdRzcVWJ.js";import{u as I}from"./useDispatch-Cxcu0s7k.js";import{u as R}from"./useBoolean-DwbfAoJh.js";import{u as B,a as T,b}from"./useGetParkingSessions-BzPBplWK.js";import{P as W}from"./ParkingActiveSessionNavigationButton-DqYz6a67.js";import{u as E}from"./useCurrentParkingPermit.web-Cdj3QSDU.js";import{P as N}from"./routes-CtH9nUKh.js";import{p as y}from"./service-CNkazZbE.js";import{u as C}from"./slice-DLdyEbbS.js";import{a as L,b as w}from"./types-C2OYdTo_.js";import{a}from"./dayjs-C6sMkNK9.js";const oe=()=>{const{navigate:u}=D(),{parkingSessions:e,isLoading:c,isError:l,refetch:r}=B(w.active),s=C(),d=E(),{value:m,enable:n}=R(!1);h.useEffect(()=>{(s==null?void 0:s.scope)!==L.visitor&&!m&&e!=null&&e.some(t=>!t.ps_right_id)&&(r(),n())},[e,m,s==null?void 0:s.scope,r,n]),T(r,e!=null&&e.some(t=>"is_paid"in t&&!t.is_paid)?5e3:0);const o=e!=null&&e.length?e.reduce((t,P)=>{const f=a(P.end_date_time);return f.isAfter(t)?t:f},a(e[0].end_date_time)):void 0,g=I();return b(()=>{g(y.util.invalidateTags(["ParkingSessions"]))},e!=null&&e.length?Math.max((o==null?void 0:o.endOf("minute").diff(a(),"milliseconds"))??0,3e4):0),c?i.jsx(j,{testID:"ParkingPermitSessionsActivePleaseWait"}):l?i.jsx(S,{testID:"ParkingActiveSessionsSummarySomethingWentWrong"}):!e||e.length<=5?i.jsxs(A,{gutter:"sm",children:[i.jsx(p,{level:"h5",testID:"ParkingPermitSessionsActiveTitle",text:"Nu actief"}),e!=null&&e.length?e.map(t=>i.jsx(W,{noEndTime:d.no_endtime,parkingSession:t},t.ps_right_id??t.vehicle_id)):i.jsx(k,{testID:"ParkingPermitSessionsActiveNotActivePhrase",children:"Er zijn geen actieve parkeersessies."})]}):i.jsx(v,{accessibilityLabel:`${e.length} actieve parkeersessies`,onPress:()=>u(N.parkingActiveSessions),testID:"ParkingPermitSessionsActiveBadgeButton",children:i.jsxs(_,{gutter:"sm",children:[i.jsx(p,{color:"link",level:"h5",testID:"ParkingPermitSessionsActiveTitle",text:"Actief"}),i.jsx(x,{color:"info",testID:"ParkingPermitSessionsActiveBadge",value:e.length})]})})};export{oe as P};
