import{j as r}from"./jsx-runtime-DNHyKP0h.js";import{r as g}from"./index-B-xgG2PE.js";import{u as R,F as D}from"./index.esm-DMWELHmA.js";import{B as S}from"./Button-DO4uDJty.js";import{S as T}from"./SomethingWentWrong-DU9X19UO.js";import{T as k}from"./TextInputField-CwpU0NGf.js";import{C as N}from"./Column-7gyNOuyI.js";import{G as B}from"./Gutter-BKlFNIbr.js";import{u as K}from"./useNavigation-BTG-U6tE.js";import{N as O}from"./NavigationRouteContext-r2xoHQdm.js";import"./usePiwikTrackCustomEventFromProps-C6BwmnPZ.js";import{u as V}from"./useDispatch-jiStvVFn.js";import{d as W,e as q,S as b,g as H,f as _,p as G}from"./service-CxSgv93J.js";import{a as J}from"./types-C2OYdTo_.js";import{P as M}from"./routes-CtH9nUKh.js";import{a as U,b as $,p as l}from"./slice-DPyehPn3.js";import{P as z}from"./index-BiinuClr.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./PressableBase-DVgDCh_S.js";import"./index-B1L6hW7y.js";import"./extends-CF3RwP-h.js";import"./index-Cm4QxXoK.js";import"./TextAncestorContext-Z5dgoe9Q.js";import"./index-DoMT7H_C.js";import"./config-BZnShabN.js";import"./Row-O3D_1Z3Z.js";import"./mapCrossAxisAlignment-DpnuLLqj.js";import"./mapMainAxisAlignment-BOa0GzUh.js";import"./useThemable-DhqiuDXa.js";import"./index-DICU_UuR.js";import"./index-CGHx0_JJ.js";import"./index-CnyDuYXe.js";import"./base-color-BCCzFoQm.js";import"./Icon-Dl1M1wsB.js";import"./index-s4hYfBOP.js";import"./index-Chjiymov.js";import"./Animated-45BN0duk.js";import"./index-DoCTQWjN.js";import"./NativeEventEmitter-CjF4_R2K.js";import"./index-u-pG-eXf.js";import"./index-CXGG-aYW.js";import"./types-CttlCamk.js";import"./useDeviceContext-BsghPmC5.js";import"./index-aqbATsDD.js";import"./index-C70cEofB.js";import"./useTheme-6yZg5PNu.js";import"./AccessibleText-ySoCsV7u.js";import"./Pressable-BSCVNBN7.js";import"./Box-BC0ke60P.js";import"./layoutStyles-Beptdp9x.js";import"./Alert.types-B-Yctuek.js";import"./AlertBase-D_xPIUj1.js";import"./SingleSelectable-UeAGsyNp.js";import"./Paragraph-6dpypvwD.js";import"./Title-j4pZys9C.js";import"./useAccessibilityFocus-aDK5TXuR.js";import"./useTrackException-9O1tSVBj.js";import"./index-TB2J_fWb.js";import"./index-996-O__M.js";import"./useIsScreenReaderEnabled-BS8Rdef4.js";import"./duration-BV61i-wJ.js";import"./accessibleText-gmNPjmn1.js";import"./useAccessibilityAnnounce-Daru9KA0.js";import"./CharactersLeftDisplay-BUJ9S6I3.js";import"./TextInput-DGry-9ic.js";import"./IconButton-BFaAtlz-.js";import"./Badge-9ENYNMId.js";import"./formatNumber-BOnMa6yj.js";import"./Label-BoChSiF9.js";import"./Phrase-CM-xrE6T.js";import"./index-shQJSbQb.js";import"./dayjs-C6sMkNK9.js";import"./index-BN0T3tkN.js";import"./client-Ci5f1cWN.js";import"./index-DKdc_Qc3.js";import"./index-DeJff1tQ.js";import"./index-sQd6WMHM.js";import"./index-C8evIbG0.js";import"./index-Cy9gAJ_F.js";import"./index-CaCnvGGV.js";import"./index-oz3Z5D95.js";import"./iframe-ChjzOsXe.js";function Q(){const t=g.useContext(O);if(t===void 0)throw new Error("Couldn't find a route object. Is your component inside a screen in a navigator?");return t}const X=()=>Q(),Y=()=>{const{setItem:t}=W();return g.useCallback((i,s)=>q(i,s).then(()=>{t(i)}),[t])},Z=t=>t===J.permitHolder?b.parkingPermitHolder:b.parkingVisitor,tt=()=>{const t=Y();return g.useCallback(async(i,s)=>{const a=Z(s);let o=[];try{const n=await H(a);if(n){let m;try{m=JSON.parse(n)}catch{m=[]}Array.isArray(m)&&(o=m.filter(e=>typeof e=="object"&&e!==null&&"reportCode"in e&&"pin"in e))}}catch{o=[]}o=o.filter(n=>n.reportCode!==i.reportCode),o.push(i),await t(a,JSON.stringify(o))},[t])},rt=()=>{const{params:t}=X(),{navigate:i}=K(),s=R({defaultValues:t}),a=g.useRef(null),{setAccessToken:o}=U(),{handleSubmit:n}=s,[m,{error:e,isError:y,isLoading:A}]=_(),F=e&&"status"in e&&e.status===403,C=tt(),{isLoggingInAdditionalAccount:j,setIsLoggingInAdditionalAccount:v}=$(),c=V(),L=F?"Controleer uw meldcode en pincode en probeer het opnieuw.":"Er is iets misgegaan. Probeer het opnieuw.",f=n(({pin:p,reportCode:u})=>{m({pin:p,report_code:u}).unwrap().then(async({access_token:w,access_token_expiration:E,scope:P})=>{await C({pin:p,reportCode:u},P),o(u,w,E),c(l.actions.setCurrentAccount(u)),c(l.actions.setCurrentPermitReportCode(void 0)),c(l.actions.setParkingAccount({reportCode:u,scope:P})),j&&v(!1),c(G.util.resetApiState())})});return r.jsx(D,{...s,children:r.jsxs(N,{gutter:"md",children:[r.jsx(k,{autoFocus:!0,keyboardType:"number-pad",label:"Meldcode",name:"reportCode",onSubmitEditing:()=>{var p;(p=a.current)==null||p.focus()},returnKeyType:z.OS!=="ios"?"done":void 0,rules:{required:"Vul een meldcode in"},submitBehavior:"submit",testID:"ParkingLoginFormReportCodeInputField"}),r.jsx(k,{enterKeyHint:"send",keyboardType:"number-pad",label:"Pincode",name:"pin",onSubmitEditing:f,ref:a,rules:{required:"Vul een pincode in"},testID:"ParkingLoginFormPinCodeInputField"}),!!y&&!A&&r.jsxs(r.Fragment,{children:[r.jsx(T,{testID:"ParkingLoginFormSomethingWentWrong",text:L,title:"Inloggen mislukt"}),r.jsx(B,{height:"lg"})]}),r.jsx(S,{label:"Pincode vergeten",onPress:()=>i(M.requestPinCode),testID:"ParkingLoginForgotPinButton",variant:"tertiary"}),r.jsx(S,{label:"Inloggen",onPress:f,testID:"ParkingLoginFormSubmitButton"})]})})},wr={component:rt},d={};var I,h,x;d.parameters={...d.parameters,docs:{...(I=d.parameters)==null?void 0:I.docs,source:{originalSource:"{}",...(x=(h=d.parameters)==null?void 0:h.docs)==null?void 0:x.source}}};const Er=["Default"];export{d as Default,Er as __namedExportsOrder,wr as default};
