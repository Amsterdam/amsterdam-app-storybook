import{r as i}from"./index-76fb7be0.js";import{c as F,V as S,a as K,P as W,b as z,d as j,e as B,M as P}from"./slugs-752d94ee.js";import"./redux-toolkit.esm-d86c6d3e.js";import{b as $,a as G,d as N}from"./development-fba0c344.js";import{u as A}from"./useSentry-4cda5aa7.js";import{j as Y}from"./index-1401012c.js";import{P as H}from"./invariant-f1a82cf7.js";import{N as k}from"./index-14cede91.js";import{S as g,s as X}from"./logging-fefb8dff.js";const p=F();var M=(t=>(t[t.searchTerm=3]="searchTerm",t[t.searchResultAmount=4]="searchResultAmount",t[t.searchType=5]="searchType",t[t.searchResultTitle=6]="searchResultTitle",t[t.searchResultUrl=7]="searchResultUrl",t[t.searchResultType=8]="searchResultType",t[t.searchResultSelected=9]="searchResultSelected",t[t.contentTitle=10]="contentTitle",t[t.contentSubject=11]="contentSubject",t[t.contentTeam=12]="contentTeam",t[t.contentPublicationDate=13]="contentPublicationDate",t[t.contentType=14]="contentType",t[t.userIntext=15]="userIntext",t[t.searchMachine=16]="searchMachine",t[t.pageType=17]="pageType",t[t.contentId=20]="contentId",t[t.newState=36]="newState",t))(M||{}),O=(t=>(t[t.userType=1]="userType",t[t.userCity=2]="userCity",t[t.appVersion=18]="appVersion",t[t.appVersionWithBuild=19]="appVersionWithBuild",t[t.reduceMotionEnabled=21]="reduceMotionEnabled",t[t.screenReaderEnabled=22]="screenReaderEnabled",t[t.accessibilityServiceEnabled=23]="accessibilityServiceEnabled",t[t.boldTextEnabled=24]="boldTextEnabled",t[t.grayscaleEnabled=25]="grayscaleEnabled",t[t.invertColorsEnabled=26]="invertColorsEnabled",t[t.reduceTransparencyEnabled=27]="reduceTransparencyEnabled",t[t.fontScale=28]="fontScale",t[t.isLandscape=29]="isLandscape",t[t.isPortrait=30]="isPortrait",t[t.isTablet=31]="isTablet",t[t.hasCameraPermission=32]="hasCameraPermission",t[t.hasPhotosPermission=33]="hasPhotosPermission",t[t.hasLocationPermission=34]="hasLocationPermission",t[t.hasNotificationPermission=35]="hasNotificationPermission",t))(O||{}),q=(t=>(t.accessibilityAction="accessibilityAction",t.accessibilityChange="accessibilityChange",t.addressAdd="addressAdd",t.addressChange="addressChange",t.buttonPress="buttonPress",t.deviceInfoChange="deviceInfoChange",t.locationOrAddressSelectionChange="locationOrAddressSelectionChange",t.radioChange="radioChange",t.startUp="startUp",t.swipeOut="swipeOut",t.toForeground="toForeground",t.toggle="toggle",t))(q||{}),R=(t=>(t.alreadyInitialized="Piwik Pro SDK has been already initialized",t.missingEnvVars="PIWIK_PRO_URL or PIWIK_PRO_ID are not defined in env",t))(R||{});const J=(t,e)=>!(e!=null&&e.id)&&typeof(e==null?void 0:e.id)!="number"?t:{...t,[M.contentId]:e.id.toString()},Q=t=>(t==null?void 0:t.screenTitle)??(t==null?void 0:t.screenHeaderTitle),Z=t=>{if(t)return Object.keys(t).filter(e=>t[e]!==void 0).reduce((e,a)=>({...e,[a]:t[a]}),{})},D={[O.appVersion]:S,[O.appVersionWithBuild]:K},b=t=>Z({...t,...D});function tt(t){if(!Number.isInteger(t))throw new Error("Parameter must be an integer number")}function T(t){t&&Object.entries(t).forEach(e=>{let[a,n]=e;const u=parseInt(a,10);if(a!==u.toString())throw new Error("ID (key) must be an integer");if(u<1)throw new Error("ID (key) must be an integer greater than 0")})}function m(t){t.forEach(e=>{let a=e.customDimensions;if(a){if(Object.keys(a).length>20)throw new Error("Max 20 product custom dimensions, 20 is max ID.");T(a)}})}function et(t){if(!/^[0-9a-f]{16}$/.test(t))throw new Error(`Visitor ID ${t} has invalid format. The format must match the regular expression: ^[0-9a-f]{16}$`)}const at="1.1.0",rt=`The package 'react-native-piwik-pro-sdk' doesn't seem to be linked. Make sure: 

`+H.select({ios:`- You have run 'pod install'
`,default:""})+`- You rebuilt the app after installing the package
- You are not using Expo managed workflow
`,r=k.PiwikProSdk?k.PiwikProSdk:new Proxy({},{get(){throw new Error(rt)}});async function ct(t,e){return await r.init(t,e,at)}async function nt(t,e){return s(e),await r.trackScreen(t,e)}async function ut(t,e,a){return s(a),await r.trackCustomEvent(t,e,a)}async function st(t,e){return s(e),await r.trackException(t,e)}async function ot(t,e,a){return s(a),await r.trackSocialInteraction(t,e,a)}async function lt(t,e){return s(e),await r.trackDownload(t,e)}async function dt(){return await r.trackApplicationInstall()}async function ft(t,e){return s(e),await r.trackOutlink(t,e)}async function it(t,e){return s(e),await r.trackSearch(t,e)}async function yt(t,e){return s(e),await r.trackImpression(t,e)}async function ht(t,e,a){return s(a),await r.trackInteraction(t,e,a)}async function gt(t,e){return s(e),await r.trackGoal(t,e)}async function It(t,e,a){return await r.trackEcommerce(t,e,a)}async function mt(t,e){return s(e),m(t),await r.trackEcommerceProductDetailView(t,e)}async function Et(t,e,a){return s(a),m(t),await r.trackEcommerceCartUpdate(t,e,a)}async function bt(t,e){return s(e),m(t),await r.trackEcommerceAddToCart(t,e)}async function Ct(t,e){return s(e),m(t),await r.trackEcommerceRemoveFromCart(t,e)}async function vt(t,e,a,n){return s(n),m(a),await r.trackEcommerceOrder(t,e,a,n)}async function Tt(t){return await r.trackCampaign(t)}async function pt(t){if(Array.isArray(t)){if(!t.length)throw new Error("Profile attributes cannot be an empty array");return await r.trackProfileAttributes(t)}return await r.trackProfileAttributes([t])}async function Rt(){return await r.getProfileAttributes()}async function _t(t){return await r.checkAudienceMembership(t)}async function Ot(t){return await r.setUserId(t)}async function Vt(){return await r.getUserId()}async function kt(t){return await r.setUserEmail(t)}async function xt(){return await r.getUserEmail()}async function Ut(t){return et(t),await r.setVisitorId(t)}async function wt(){return await r.getVisitorId()}async function Nt(t){return await r.setSessionTimeout(t)}async function At(){return await r.getSessionTimeout()}async function Mt(){return await r.startNewSession()}async function Lt(){return await r.dispatch()}async function Ft(t){return tt(t),await r.setDispatchInterval(t)}async function St(){return await r.getDispatchInterval()}async function Kt(t){return await r.setIncludeDefaultCustomVariables(t)}async function Wt(){return await r.getIncludeDefaultCustomVariables()}async function zt(t){return await r.setAnonymizationState(t)}async function jt(){return await r.isAnonymizationOn()}async function Bt(t){return await r.setOptOut(t)}async function Pt(t){return await r.setDryRun(t)}async function $t(){return await r.getDryRun()}async function Gt(){return await r.getOptOut()}async function Yt(t){return await r.setPrefixing(t)}async function Ht(){return await r.isPrefixingOn()}function s(t){T(t==null?void 0:t.customDimensions),T(t==null?void 0:t.visitCustomVariables),T(t==null?void 0:t.screenCustomVariables)}const I={init:ct,trackScreen:nt,trackCustomEvent:ut,trackException:st,trackSocialInteraction:ot,trackDownload:lt,trackApplicationInstall:dt,trackOutlink:ft,trackSearch:it,trackImpression:yt,trackInteraction:ht,trackGoal:gt,trackEcommerce:It,trackEcommerceProductDetailView:mt,trackEcommerceCartUpdate:Et,trackEcommerceAddToCart:bt,trackEcommerceRemoveFromCart:Ct,trackEcommerceOrder:vt,trackCampaign:Tt,trackProfileAttributes:pt,getProfileAttributes:Rt,checkAudienceMembership:_t,setUserId:Ot,getUserId:Vt,setUserEmail:kt,getUserEmail:xt,setVisitorId:Ut,getVisitorId:wt,setSessionTimeout:Nt,getSessionTimeout:At,startNewSession:Mt,dispatch:Lt,setDispatchInterval:Ft,getDispatchInterval:St,setIncludeDefaultCustomVariables:Kt,getIncludeDefaultCustomVariables:Wt,setAnonymizationState:zt,isAnonymizationOn:jt,setOptOut:Bt,getOptOut:Gt,setDryRun:Pt,getDryRun:$t,setPrefixing:Yt,isPrefixingOn:Ht},[x,U]=$?[W,z]:[j,B],Xt=async()=>!x||!U?Promise.reject(R.missingEnvVars):(await I.init(x,U),await I.trackApplicationInstall(),await I.setIncludeDefaultCustomVariables(!0),Promise.resolve()),_=i.createContext(void 0),w=({children:t})=>{const{sendSentryErrorLog:e}=A(),[a,n]=i.useState();return i.useEffect(()=>{a===void 0&&Xt().then(()=>{n(I)}).catch(u=>{if(u.message===R.alreadyInitialized){n(I);return}n(null),u.message!==R.missingEnvVars&&e(g.piwikInitialization,"piwik.provider.tsx",{error:u})})},[a,e]),Y(_.Provider,{value:a,children:t})};try{_.displayName="PiwikContext",_.__docgenInfo={description:"The PiwikContext contains the object with all methods, to be used via the usePiwik hook only.",displayName:"PiwikContext",props:{}}}catch{}try{w.displayName="PiwikProvider",w.__docgenInfo={description:"",displayName:"PiwikProvider",props:{}}}catch{}const qt=()=>{if(p.isReady()){const t=p.getRootState(),e=t==null?void 0:t.routes;if(e)for(let a=e.length-1;a>=0;a--){const n=P[e[a].name];if(n)return n}}},C=()=>N("piwik not initialized"),Jt={ready:!1,trackCustomEvent:C,trackOutlink:C,trackScreen:C,trackSearch:C},v="usePiwik.ts",Qt=({trackCustomEvent:t,trackOutlink:e,trackScreen:a,trackSearch:n},u,E,f,y)=>({ready:!0,trackCustomEvent:(o,c,l,d=E,h=void 0)=>{G("trackCustomEvent",{name:o,action:c,dimensions:l,category:d,value:h}),t(d,c,{path:f,customDimensions:b(l),value:h}).catch(()=>{u(g.piwikTrackCustomEvent,v,{category:d,action:c,name:o,path:f,value:h})})},trackOutlink:(o,c)=>{const l=X(o);e(l,{...c,customDimensions:b(c==null?void 0:c.customDimensions)}).catch(()=>{u(g.piwikTrackOutlink,v,{url:l})})},trackScreen:(o,c)=>{const l=o??f;if(!l)return;const d=J(c==null?void 0:c.customDimensions,y);a(l,{...c,title:Q(y),customDimensions:b(d)}).catch(()=>{u(g.piwikTrackScreen,v,{path:o})})},trackSearch:(o,c)=>{n(o,{...c,customDimensions:b(c==null?void 0:c.customDimensions)}).catch(()=>{u(g.piwikTrackSearch,v)})}}),Zt=()=>{const t=i.useContext(_),{sendSentryErrorLog:e}=A(),a=p.isReady()?p.getCurrentRoute():void 0,n=qt()??"general";return i.useMemo(()=>t?Qt(t,e,n,a==null?void 0:a.name,a==null?void 0:a.params):Jt,[t,e,n,a==null?void 0:a.name,a==null?void 0:a.params])},Dt=t=>{const e=t.logName??t["sentry-label"]??t.testID;return e||N("No name found in props"),e},le=({logAction:t,logCategory:e,logDimensions:a={},logValue:n,onEvent:u,testID:E,logName:f,"sentry-label":y})=>{const{trackCustomEvent:o}=Zt();return i.useCallback((c,{nameSuffix:l,dimensions:d={},action:h=t}={})=>{u==null||u(c);const V=Dt({testID:E,logName:f,"sentry-label":y});if(V){const L=l?`:${l}`:"";o(`${V}${L}`,h,{...a,...d},e,n)}},[t,e,a,f,n,u,y,E,o])};export{q as P,M as a,qt as g,le as u};
