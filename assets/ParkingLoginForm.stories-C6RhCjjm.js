import{j as o}from"./jsx-runtime-DNHyKP0h.js";import{r as g}from"./index-B-xgG2PE.js";import{u as N,F as _}from"./index.esm-DMWELHmA.js";import{B as b}from"./Button-CMbI3DlX.js";import{S as B}from"./SomethingWentWrong-BgMD9GoF.js";import{T as h}from"./TextInputField-CS-9M-wc.js";import{C as O}from"./Column-C2iN62cF.js";import{G as V}from"./Gutter-BifjMlD9.js";import{u as W}from"./useNavigation-CzlnAToN.js";import{N as q}from"./NavigationRouteContext-r2xoHQdm.js";import"./usePiwikTrackCustomEventFromProps-DTbmA5EW.js";import{u as G}from"./useDispatch-jiStvVFn.js";import{u as K,a as H}from"./useLoginSteps-C_WzGQFZ.js";import{e as J,f as M,g as U,S as x,h as $,p as z}from"./service-Bts90kxW.js";import{a as Q}from"./types-C2OYdTo_.js";import{P as y}from"./routes-CtH9nUKh.js";import{d as X,p as S}from"./slice-B4FivVli.js";import{d as Y}from"./useTrackException-BuwXEiys.js";import{P as Z}from"./index-BiinuClr.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./PressableBase-C_jsYHwg.js";import"./index-8vBCaO0e.js";import"./extends-CF3RwP-h.js";import"./index-Cm4QxXoK.js";import"./TextAncestorContext-Z5dgoe9Q.js";import"./index-DoMT7H_C.js";import"./config-BZnShabN.js";import"./Row-CuANDzas.js";import"./mapCrossAxisAlignment-DpnuLLqj.js";import"./mapMainAxisAlignment-BOa0GzUh.js";import"./useThemable-DhqiuDXa.js";import"./index-DICU_UuR.js";import"./index-CGHx0_JJ.js";import"./index-CnyDuYXe.js";import"./base-color-BCCzFoQm.js";import"./Icon-ibmUWV0d.js";import"./index-s4hYfBOP.js";import"./index-Chjiymov.js";import"./Animated-45BN0duk.js";import"./index-DoCTQWjN.js";import"./NativeEventEmitter-CjF4_R2K.js";import"./index-u-pG-eXf.js";import"./index-CXGG-aYW.js";import"./types-CttlCamk.js";import"./useDeviceContext-BsghPmC5.js";import"./index-aqbATsDD.js";import"./index-C70cEofB.js";import"./useTheme-6yZg5PNu.js";import"./AccessibleText-ySoCsV7u.js";import"./Pressable-GZlqOX4K.js";import"./Box-DxJkmPWh.js";import"./layoutStyles-Beptdp9x.js";import"./Alert.types-B-Yctuek.js";import"./AlertBase-Bdsf9_kA.js";import"./SingleSelectable-UeAGsyNp.js";import"./Paragraph-ePXUBViJ.js";import"./Title-CoufoEF_.js";import"./useAccessibilityFocus-Caw8Leih.js";import"./index-TB2J_fWb.js";import"./index-996-O__M.js";import"./useIsScreenReaderEnabled-CpYBVHk9.js";import"./duration-BV61i-wJ.js";import"./accessibleText-gmNPjmn1.js";import"./useAccessibilityAnnounce-64AxzTCn.js";import"./CharactersLeftDisplay-DnEfvwQf.js";import"./TextInput-DyARpz41.js";import"./IconButton-BcCRzrrD.js";import"./Badge-BB0o_wnH.js";import"./formatNumber-BOnMa6yj.js";import"./Label-DE0Tb7ME.js";import"./Phrase-DrZuqGVl.js";import"./index-shQJSbQb.js";import"./dayjs-C6sMkNK9.js";import"./index-BC3CZ5Nb.js";import"./client-Ci5f1cWN.js";import"./index-DKdc_Qc3.js";import"./index-DeJff1tQ.js";import"./index-sQd6WMHM.js";import"./index-C8evIbG0.js";import"./index-Cy9gAJ_F.js";import"./index-PBkblRt8.js";import"./index-oz3Z5D95.js";import"./iframe-D0UJ9Uce.js";function tt(){const t=g.useContext(q);if(t===void 0)throw new Error("Couldn't find a route object. Is your component inside a screen in a navigator?");return t}const rt=()=>tt(),ot=()=>{const{setItem:t}=J();return g.useCallback((i,m)=>M(i,m).then(()=>{t(i)}),[t])},et=t=>t===Q.permitHolder?x.parkingPermitHolder:x.parkingVisitor,it=()=>{const t=ot();return g.useCallback(async(i,m)=>{const c=et(m);let r=[];try{const e=await U(c);if(e){let n;try{n=JSON.parse(e)}catch{n=[]}Array.isArray(n)&&(r=n.filter(s=>typeof s=="object"&&s!==null&&"reportCode"in s&&"pin"in s))}}catch{r=[]}r=r.filter(e=>e.reportCode!==i.reportCode),r.push(i),await t(c,JSON.stringify(r))},[t])},nt=()=>{const{params:t}=rt(),i=W(),{navigate:m,reset:c}=i,r=N({defaultValues:t}),e=g.useRef(null),{setAccessToken:n}=X(),{accessCode:s}=K(),{isLoginStepsActive:A}=H(),{handleSubmit:j}=r,[v,{error:l,isError:L,isLoading:w}]=$(),E=l&&"status"in l&&l.status===403,R=it(),u=G(),T=E?"Controleer uw meldcode en pincode en probeer het opnieuw.":"Er is iets misgegaan. Probeer het opnieuw.",P=j(async({pin:a,reportCode:p})=>{try{const{access_token:f,access_token_expiration:D,scope:k}=await v({pin:a,report_code:p}).unwrap();await R({pin:a,reportCode:p},k),n(p,f,D),u(S.actions.setCurrentAccount(p)),u(S.actions.setCurrentPermitReportCode(void 0)),u(S.actions.setParkingAccount({reportCode:p,scope:k})),u(z.util.resetApiState()),setTimeout(()=>{s&&!A&&c({index:0,routes:[{name:y.dashboard}]})},1e3)}catch(f){Y("ParkingLoginForm onSubmit error:",f)}});return o.jsx(_,{...r,children:o.jsxs(O,{gutter:"md",children:[o.jsx(h,{autoFocus:!0,keyboardType:"number-pad",label:"Meldcode",name:"reportCode",onSubmitEditing:()=>{var a;(a=e.current)==null||a.focus()},returnKeyType:Z.OS!=="ios"?"done":void 0,rules:{required:"Vul een meldcode in"},submitBehavior:"submit",testID:"ParkingLoginFormReportCodeInputField"}),o.jsx(h,{keyboardType:"number-pad",label:"Pincode",name:"pin",onSubmitEditing:P,ref:e,rules:{required:"Vul een pincode in"},testID:"ParkingLoginFormPinCodeInputField"}),!w&&!!L&&o.jsxs(o.Fragment,{children:[o.jsx(B,{testID:"ParkingLoginFormSomethingWentWrong",text:T,title:"Inloggen mislukt"}),o.jsx(V,{height:"lg"})]}),o.jsx(b,{label:"Pincode vergeten",onPress:()=>m(y.requestPinCode),testID:"ParkingLoginForgotPinButton",variant:"tertiary"}),o.jsx(b,{disabled:r.formState.isSubmitting,label:"Inloggen",onPress:P,testID:"ParkingLoginFormSubmitButton"})]})})},Nr={component:nt},d={};var I,C,F;d.parameters={...d.parameters,docs:{...(I=d.parameters)==null?void 0:I.docs,source:{originalSource:"{}",...(F=(C=d.parameters)==null?void 0:C.docs)==null?void 0:F.source}}};const _r=["Default"];export{d as Default,_r as __namedExportsOrder,Nr as default};
