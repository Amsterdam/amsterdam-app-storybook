import{a8 as P,a9 as p,aa as v,ab as x,r as j,ac as S,a6 as n,ad as A,ae as _,j as t,S as k,n as D,o as m,f as I,P as R,R as b,g as B,af as W}from"./iframe-Bfbvpq6X.js";import{P as N}from"./PleaseWait-D8xqQdt8.js";import{u as T,a as y,b as E}from"./useGetParkingSessions-CKs9iUrt.js";import{P as L}from"./ParkingSessionNavigationButton-CrFwi4r0.js";const M=()=>{const{navigate:g}=P(),{parkingSessions:e,isLoading:d,isError:u,refetch:a}=T(p.active),i=v(),{value:o,enable:l}=x(!1);j.useEffect(()=>{(i==null?void 0:i.scope)!==S.visitor&&!o&&e!=null&&e.some(s=>!s.ps_right_id)&&(a(),l())},[e,o,i==null?void 0:i.scope,a,l]),y(a,e!=null&&e.some(s=>"is_paid"in s&&!s.is_paid)?5e3:0);const r=e!=null&&e.length?e.reduce((s,f)=>{const c=n(f.end_date_time);return c.isAfter(s)?s:c},n(e[0].end_date_time)):void 0,h=A();return E(()=>{h(_.util.invalidateTags(["ParkingSessions"]))},e!=null&&e.length?Math.max((r==null?void 0:r.endOf("minute").diff(n(),"milliseconds"))??0,3e4):0),d?t.jsx(N,{testID:"ParkingPermitSessionsActivePleaseWait"}):u?t.jsx(k,{testID:"ParkingActiveSessionsSummarySomethingWentWrong"}):!e||e.length<=5?t.jsxs(D,{gutter:"sm",children:[t.jsx(m,{level:"h5",testID:"ParkingPermitSessionsActiveTitle",text:"Nu actief"}),e!=null&&e.length?e.map(s=>t.jsx(L,{parkingSession:s},s.ps_right_id??s.vehicle_id)):t.jsx(I,{testID:"ParkingPermitSessionsActiveNotActivePhrase",children:"Er zijn geen actieve parkeersessies."})]}):t.jsx(R,{accessibilityLabel:`${e.length} actieve parkeersessies`,onPress:()=>g(W.parkingActiveSessions),testID:"ParkingPermitSessionsActiveBadgeButton",children:t.jsxs(b,{gutter:"sm",children:[t.jsx(m,{color:"link",level:"h5",testID:"ParkingPermitSessionsActiveTitle",text:"Actief"}),t.jsx(B,{color:"info",testID:"ParkingPermitSessionsActiveBadge",value:e.length})]})})};export{M as P};
