import{c as M,aP as N,N as O,r as l,E as v,a4 as z,aQ as V,aR as y,aS as h,aT as W,aA as H,aO as d,aU as J,aV as Q,aM as G,aW as X,a as Y,aX as _,aF as Z,aY as $,f as R,j as a,P as K}from"./iframe-DEChLOno.js";import{u as ee,F as te}from"./index.esm-DEFSCFSP.js";import{B as re}from"./Button-CO7jHTht.js";import{T as C,F as ie}from"./TextInputField-61tMy1C6.js";import{C as x}from"./Column-CXC3ZJ4q.js";import{u as ne,I as se}from"./useOpenWebUrl-CnQkIvQY.js";import{P as oe}from"./Paragraph-DD0Esipp.js";import{u as T}from"./useTrackException-DmiG9XSR.js";import"./preload-helper-Dp1pzeXC.js";import"./PressableBase-DRyoiHt6.js";import"./usePiwikTrackCustomEventFromProps-HAj55Hf2.js";import"./config-BZnShabN.js";import"./Row-CbAlU6tY.js";import"./mapCrossAxisAlignment-DpnuLLqj.js";import"./mapMainAxisAlignment-BOa0GzUh.js";import"./useThemable-BHSrwbDZ.js";import"./Icon-DwYWQUEE.js";import"./index-BnL3ZBv0.js";import"./types-CVDZqz9V.js";import"./useDeviceContext-B-3hLlZb.js";import"./AccessibleText-Bzqwrg6t.js";import"./CharactersLeftDisplay-CYKL_7rw.js";import"./ErrorMessage-DH0_mPVK.js";import"./TextInput-DP-wqzdN.js";import"./index-BDKPpuNM.js";import"./index-2dCH_Lfm.js";import"./gestureObjects-BJEZiehK.js";import"./IconButton-CqxCk2kH.js";import"./Pressable-ZCi4_c5S.js";import"./Box-CY_cUHEL.js";import"./layoutStyles-D263OpbN.js";import"./Badge-DPiq5iA5.js";import"./formatNumber-BOnMa6yj.js";import"./Label-Dvz6S2Bv.js";import"./Phrase-BiLMRzux.js";import"./useAccessibilityAnnounce-C64v4o-m.js";import"./useIsScreenReaderEnabled-BahJCF-v.js";import"./duration-ScJItaFq.js";var j=(e=>(e.getRedirectUrls="getRedirectUrls",e))(j||{}),w=(e=>(e.acknowledgeChild="acknowledgeChild",e.birth="birth",e.chatPrivacy="chatPrivacy",e.cityPassChildBudget="cityPassChildBudget",e.cityPassRequest="cityPassRequest",e.cityPassUsage="cityPassUsage",e.citypass="citypass",e.contactForm="contactForm",e.contactNewsletterSignup="contactNewsletterSignup",e.documents="documents",e.elections="elections",e.feedbackForm="feedbackForm",e.immigration="immigration",e.income_help="income_help",e.lifelessBirth="lifelessBirth",e.makeAppointMentWeesp="makeAppointMentWeesp",e.marriage="marriage",e.marriagePermission="marriagePermission",e.my_parking="my_parking",e.naturalisation="naturalisation",e.parking="parking",e.parking_request_license_plate_ga_bewoners="parking_request_license_plate_ga_bewoners",e.parking_request_license_plate_ga_bezoekers="parking_request_license_plate_ga_bezoekers",e.parking_request_license_plate_mantelzorgers="parking_request_license_plate_mantelzorgers",e.passing="passing",e.passingForFuneralDirectors="passingForFuneralDirectors",e.relocation="relocation",e.rivm_report="rivm_report",e.sailingAndMooring="sailingAndMooring",e.waste="waste",e))(w||{});const ae=M.injectEndpoints({endpoints:e=>({[j.getRedirectUrls]:e.query({query:()=>({slug:O.contact,url:"/links"}),keepUnusedDataFor:N.hour})}),overrideExisting:!0}),{useGetRedirectUrlsQuery:ce}=ae,le=()=>{const e=ne(),{data:t,isLoading:s,isError:p,refetch:r}=ce(),i=T();return{openRedirect:l.useCallback(n=>{!t&&!s&&r(),n&&(t!=null&&t[n])?e(t[n]):(z.alert(`Sorry, deze functie is ${t?"":"even "}niet beschikbaar.`,t?"":"Probeer het later opnieuw."),t&&i(v.redirectNotFound,"Redirects.tsx",{urlKey:n,redirectsAvailable:!!t}))},[s,e,t,r,i]),isLoading:s,isError:p,redirectUrls:t}},pe=()=>{const{setItem:e}=V();return l.useCallback((t,s)=>y(t,s).then(()=>{e(t)}),[e])},ue=e=>e===H.permitHolder?h.parkingPermitHolder:h.parkingVisitor,me=()=>{const e=pe();return l.useCallback(async(t,s)=>{const p=ue(s);let r=[];try{const i=await W(p);if(i){let c;try{c=JSON.parse(i)}catch{c=[]}Array.isArray(c)&&(r=c.filter(n=>typeof n=="object"&&n!==null&&"reportCode"in n&&"pin"in n))}}catch{r=[]}r=r.filter(i=>i.reportCode!==t.reportCode),r.push(t),await e(p,JSON.stringify(r))},[e])},ge=e=>{if(!e)return;const t="data"in e&&e.data&&typeof e.data=="object"&&"code"in e.data&&e.data.code;return t==="SSP_BAD_CREDENTIALS"?d.loginForbiddenFailed:t==="SSP_ACCOUNT_INACTIVE"?d.loginAccountInactiveFailed:t==="SSP_ACCOUNT_BLOCKED"?d.loginAccountBlockedFailed:d.loginFailed},de=()=>{const e=J(),t=ee({defaultValues:e}),s=l.useRef(null),{setAccessToken:p}=Q(),{resetAlert:r,setAlert:i}=G(),c=T(),{openRedirect:n}=le(),{handleSubmit:D,setValue:f}=t,[U,{error:P,isError:S,isLoading:b}]=X(),B=me(),u=Y(),A=D(async({pin:o,reportCode:m})=>{try{const{access_token:g,access_token_expiration:q,scope:F}=await U({pin:o,report_code:m}).unwrap();await B({pin:o,reportCode:m},F),p(m,g,q),u(_.actions.setCurrentAccount(m)),u(_.actions.setCurrentPermitReportCode(void 0)),u(_.actions.setParkingAccount({reportCode:m,scope:F})),u(Z.util.resetApiState()),u($(!1))}catch(g){c(v.parkingLoginFailed,"ParkingLoginForm.tsx",{error:g}),R("ParkingLoginForm onSubmit error:",g)}});return l.useEffect(()=>{e&&(f("reportCode",e.reportCode),f("pin",e.pin))},[e,f]),l.useEffect(()=>{if(!S)return;const o=ge(P);o&&i(o)},[S,P,i]),l.useEffect(()=>{b&&r()},[b,r]),a.jsx(te,{...t,children:a.jsxs(x,{gutter:"xl",children:[a.jsxs(x,{gutter:"md",children:[a.jsx(C,{autoFocus:!0,hasClearButton:!1,keyboardType:"numbers-and-punctuation",label:"Meldcode",name:"reportCode",onSubmitEditing:()=>{var o;(o=s.current)==null||o.focus()},returnKeyType:K.OS==="android"?"done":void 0,rules:{required:"Vul een meldcode in"},submitBehavior:"submit",testID:"ParkingLoginFormReportCodeInputField",textTransform:o=>o.replaceAll(/[^a-zA-Z0-9]/g,"").toUpperCase()}),a.jsx(C,{fieldType:ie.pin,hasClearButton:!1,label:"Pincode",name:"pin",onSubmitEditing:A,ref:s,rules:{required:"Vul een pincode in"},testID:"ParkingLoginFormPinCodeInputField"}),a.jsxs(oe,{children:["Meld- of pincode kwijt? U vindt ze in"," ",a.jsx(se,{isExternal:!0,"logging-label":"ParkingLoginFormInlineLink",onPress:()=>n(w.my_parking),testID:"ParkingLoginFormInlineLink",children:"Mijn Parkeren"})]})]}),a.jsx(re,{isLoading:t.formState.isSubmitting,label:"Inloggen",onPress:A,testID:"ParkingLoginFormSubmitButton"})]})})},Ke={component:de},k={};var I,E,L;k.parameters={...k.parameters,docs:{...(I=k.parameters)==null?void 0:I.docs,source:{originalSource:"{}",...(L=(E=k.parameters)==null?void 0:E.docs)==null?void 0:L.source}}};const et=["Default"];export{k as Default,et as __namedExportsOrder,Ke as default};
