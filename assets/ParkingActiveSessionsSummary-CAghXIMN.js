import{aF as h,aA as P,r as v,aB as x,ap as o,a as j,aG as S,j as s,aC as A}from"./iframe-DLsJoctm.js";import{P as _}from"./Pressable-BcpCMD7W.js";import{B as k}from"./Badge-khsv4uVA.js";import{P as B}from"./PleaseWait-C2016OO3.js";import{S as D}from"./SomethingWentWrong-Cw-sEyVO.js";import{C as I}from"./Column-Cr3YZdtT.js";import{R}from"./Row-BMbu_2XQ.js";import{P as T}from"./Phrase-CeX_rREt.js";import{T as c}from"./Title-GLFT_7cM.js";import{u as W}from"./useNavigation-D63Kr8H6.js";import{u as b}from"./useBoolean-Ccw-SuWk.js";import{u as N,a as y,b as E}from"./useGetParkingSessions-C2H3kFUY.js";import{P as C}from"./ParkingSessionNavigationButton-Dtplym3z.js";const U=()=>{const{navigate:f}=W(),{parkingSessions:e,isLoading:u,isError:p,refetch:r}=N(h.active),i=P(),{value:n,enable:m}=b(!1);v.useEffect(()=>{(i==null?void 0:i.scope)!==x.visitor&&!n&&e!=null&&e.some(t=>!t.ps_right_id)&&(r(),m())},[e,n,i==null?void 0:i.scope,r,m]),y(r,e!=null&&e.some(t=>"is_paid"in t&&!t.is_paid)?5e3:0);const a=e!=null&&e.length?e.reduce((t,d)=>{const l=o(d.end_date_time);return l.isAfter(t)?t:l},o(e[0].end_date_time)):void 0,g=j();return E(()=>{g(S.util.invalidateTags(["ParkingSessions"]))},e!=null&&e.length?Math.max((a==null?void 0:a.endOf("minute").diff(o(),"milliseconds"))??0,3e4):0),u?s.jsx(B,{testID:"ParkingPermitSessionsActivePleaseWait"}):p?s.jsx(D,{testID:"ParkingActiveSessionsSummarySomethingWentWrong"}):!e||e.length<=5?s.jsxs(I,{gutter:"sm",children:[s.jsx(c,{level:"h5",testID:"ParkingPermitSessionsActiveTitle",text:"Nu actief"}),e!=null&&e.length?e.map(t=>s.jsx(C,{parkingSession:t},t.ps_right_id??t.vehicle_id)):s.jsx(T,{testID:"ParkingPermitSessionsActiveNotActivePhrase",children:"Er zijn geen actieve parkeersessies."})]}):s.jsx(_,{accessibilityLabel:`${e.length} actieve parkeersessies`,onPress:()=>f(A.parkingActiveSessions),testID:"ParkingPermitSessionsActiveBadgeButton",children:s.jsxs(R,{gutter:"sm",children:[s.jsx(c,{color:"link",level:"h5",testID:"ParkingPermitSessionsActiveTitle",text:"Actief"}),s.jsx(k,{color:"info",testID:"ParkingPermitSessionsActiveBadge",value:e.length})]})})};export{U as P};
