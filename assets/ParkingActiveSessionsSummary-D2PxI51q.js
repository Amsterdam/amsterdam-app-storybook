import{u as P,ba as p,a_ as x,b7 as v,r as j,a$ as S,aY as n,bb as _,bc as b,j as t,x as A,C as k,T as m,c as D,m as I,R,t as B,b0 as T}from"./iframe-BPm5eRDL.js";import{P as W}from"./PleaseWait-BQAJX3aQ.js";import{u as N,a as y,b as E}from"./useGetParkingSessions-D-Fmcr7r.js";import{P as C}from"./ParkingSessionNavigationButton-BxaOw3zy.js";const G=()=>{const{navigate:u}=P(),{parkingSessions:e,isLoading:g,isError:d,refetch:a}=N(p.active),i=x(),{value:o,enable:l}=v(!1);j.useEffect(()=>{(i==null?void 0:i.scope)!==S.visitor&&!o&&e!=null&&e.some(s=>!s.ps_right_id)&&(a(),l())},[e,o,i==null?void 0:i.scope,a,l]),y(a,e!=null&&e.some(s=>"is_paid"in s&&!s.is_paid)?5e3:0);const r=e!=null&&e.length?e.reduce((s,f)=>{const c=n(f.end_date_time);return c.isAfter(s)?s:c},n(e[0].end_date_time)):void 0,h=_();return E(()=>{h(b.util.invalidateTags(["ParkingSessions"]))},e!=null&&e.length?Math.max((r==null?void 0:r.endOf("minute").diff(n(),"milliseconds"))??0,3e4):0),g?t.jsx(W,{testID:"ParkingPermitSessionsActivePleaseWait"}):d?t.jsx(A,{testID:"ParkingActiveSessionsSummarySomethingWentWrong"}):!e||e.length<=5?t.jsxs(k,{gutter:"sm",children:[t.jsx(m,{level:"h5",testID:"ParkingPermitSessionsActiveTitle",text:"Nu actief"}),e!=null&&e.length?e.map(s=>t.jsx(C,{parkingSession:s},s.ps_right_id??s.vehicle_id)):t.jsx(D,{testID:"ParkingPermitSessionsActiveNotActivePhrase",children:"Er zijn geen actieve parkeersessies."})]}):t.jsx(I,{accessibilityLabel:`${e.length} actieve parkeersessies`,onPress:()=>u(T.parkingActiveSessions),testID:"ParkingPermitSessionsActiveBadgeButton",children:t.jsxs(R,{gutter:"sm",children:[t.jsx(m,{color:"link",level:"h5",testID:"ParkingPermitSessionsActiveTitle",text:"Actief"}),t.jsx(B,{color:"info",testID:"ParkingPermitSessionsActiveBadge",value:e.length})]})})};export{G as P};
