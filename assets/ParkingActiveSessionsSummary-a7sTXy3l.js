import{a0 as P,a1 as p,a2 as v,a3 as x,r as j,a4 as S,_ as n,a5 as _,a6 as A,j as t,C as k,T as c,f as D,P as I,R,g as B,a7 as T}from"./iframe-DTT7hwtZ.js";import{P as W}from"./PleaseWait-BK-uzZWW.js";import{S as b}from"./SomethingWentWrong-CXLvcRmx.js";import{u as N,a as y,b as E}from"./useGetParkingSessions-CQMoXTPq.js";import{P as C}from"./ParkingSessionNavigationButton-DE2LRcXt.js";const O=()=>{const{navigate:g}=P(),{parkingSessions:e,isLoading:u,isError:d,refetch:a}=N(p.active),i=v(),{value:o,enable:l}=x(!1);j.useEffect(()=>{(i==null?void 0:i.scope)!==S.visitor&&!o&&e!=null&&e.some(s=>!s.ps_right_id)&&(a(),l())},[e,o,i==null?void 0:i.scope,a,l]),y(a,e!=null&&e.some(s=>"is_paid"in s&&!s.is_paid)?5e3:0);const r=e!=null&&e.length?e.reduce((s,f)=>{const m=n(f.end_date_time);return m.isAfter(s)?s:m},n(e[0].end_date_time)):void 0,h=_();return E(()=>{h(A.util.invalidateTags(["ParkingSessions"]))},e!=null&&e.length?Math.max((r==null?void 0:r.endOf("minute").diff(n(),"milliseconds"))??0,3e4):0),u?t.jsx(W,{testID:"ParkingPermitSessionsActivePleaseWait"}):d?t.jsx(b,{testID:"ParkingActiveSessionsSummarySomethingWentWrong"}):!e||e.length<=5?t.jsxs(k,{gutter:"sm",children:[t.jsx(c,{level:"h5",testID:"ParkingPermitSessionsActiveTitle",text:"Nu actief"}),e!=null&&e.length?e.map(s=>t.jsx(C,{parkingSession:s},s.ps_right_id??s.vehicle_id)):t.jsx(D,{testID:"ParkingPermitSessionsActiveNotActivePhrase",children:"Er zijn geen actieve parkeersessies."})]}):t.jsx(I,{accessibilityLabel:`${e.length} actieve parkeersessies`,onPress:()=>g(T.parkingActiveSessions),testID:"ParkingPermitSessionsActiveBadgeButton",children:t.jsxs(R,{gutter:"sm",children:[t.jsx(c,{color:"link",level:"h5",testID:"ParkingPermitSessionsActiveTitle",text:"Actief"}),t.jsx(B,{color:"info",testID:"ParkingPermitSessionsActiveBadge",value:e.length})]})})};export{O as P};
