import{c as M,aP as N,N as O,r as p,E as v,a4 as z,aQ as V,aR as y,aS as h,aT as W,aA as H,aO as d,aU as J,aV as Q,aM as G,aW as X,a as Y,aX as _,aF as Z,aY as $,f as R,j as a,P as K}from"./iframe-qe0INbMr.js";import{u as ee,F as te}from"./index.esm-CBMzZ2nZ.js";import{B as re}from"./Button-BULHldaF.js";import{T as C,F as ne}from"./TextInputField-BtmBHtAG.js";import{C as I}from"./Column-wIfNt4zT.js";import{u as ie,I as oe}from"./useOpenWebUrl-CthV74L2.js";import{P as se}from"./Paragraph-BQMG_Ifu.js";import{u as w}from"./useTrackException-BgyLjJ79.js";import"./preload-helper-Dp1pzeXC.js";import"./PressableBase-D35QwUjX.js";import"./usePiwikTrackCustomEventFromProps-Bw0wGdtJ.js";import"./config-BZnShabN.js";import"./Row-CWKJjLil.js";import"./mapCrossAxisAlignment-DpnuLLqj.js";import"./mapMainAxisAlignment-BOa0GzUh.js";import"./useThemable-5uTNxfMU.js";import"./Icon-B0hwTWKz.js";import"./index-DDa9BrUz.js";import"./types-CVDZqz9V.js";import"./useDeviceContext-CyxuN0bh.js";import"./AccessibleText-BRexHAyS.js";import"./CharactersLeftDisplay-rm2ciwda.js";import"./ErrorMessage-CxUl5fao.js";import"./TextInput-DKxwH9Oc.js";import"./index-sEmtqgpL.js";import"./index-CT6VpK1I.js";import"./gestureObjects-BkLUV_2V.js";import"./IconButton-DhMvgj98.js";import"./Pressable-Xr49Dp_d.js";import"./Box-B_Ar6mPo.js";import"./layoutStyles-Drkrek53.js";import"./Badge-D5o7ql3N.js";import"./formatNumber-BOnMa6yj.js";import"./Label-JqW8CeGI.js";import"./Phrase-C81fJJUJ.js";import"./useAccessibilityAnnounce-DG1A-xit.js";import"./useIsScreenReaderEnabled-DiBqDZux.js";import"./duration-BBfG8XYL.js";var T=(e=>(e.getRedirectUrls="getRedirectUrls",e))(T||{}),j=(e=>(e.acknowledgeChild="acknowledgeChild",e.birth="birth",e.chatPrivacy="chatPrivacy",e.cityPassChildBudget="cityPassChildBudget",e.cityPassLowIncomeSupport="cityPassLowIncomeSupport",e.cityPassRequest="cityPassRequest",e.cityPassUsage="cityPassUsage",e.citypass="citypass",e.contactForm="contactForm",e.contactNewsletterSignup="contactNewsletterSignup",e.documents="documents",e.elections="elections",e.feedbackForm="feedbackForm",e.immigration="immigration",e.income_help="income_help",e.lifelessBirth="lifelessBirth",e.makeAppointMentWeesp="makeAppointMentWeesp",e.marriage="marriage",e.marriagePermission="marriagePermission",e.my_parking="my_parking",e.naturalisation="naturalisation",e.parking="parking",e.parking_request_license_plate_ga_bewoners="parking_request_license_plate_ga_bewoners",e.parking_request_license_plate_ga_bezoekers="parking_request_license_plate_ga_bezoekers",e.parking_request_license_plate_mantelzorgers="parking_request_license_plate_mantelzorgers",e.passing="passing",e.passingForFuneralDirectors="passingForFuneralDirectors",e.relocation="relocation",e.rivm_report="rivm_report",e.sailingAndMooring="sailingAndMooring",e.waste="waste",e))(j||{});const ae=M.injectEndpoints({endpoints:e=>({[T.getRedirectUrls]:e.query({query:()=>({slug:O.contact,url:"/links"}),keepUnusedDataFor:N.hour})}),overrideExisting:!0}),{useGetRedirectUrlsQuery:ce}=ae,pe=()=>{const e=ie(),{data:t,isLoading:o,isError:l,refetch:r}=ce(),n=w();return{openRedirect:p.useCallback(i=>{!t&&!o&&r(),i&&(t!=null&&t[i])?e(t[i]):(z.alert(`Sorry, deze functie is ${t?"":"even "}niet beschikbaar.`,t?"":"Probeer het later opnieuw."),t&&n(v.redirectNotFound,"Redirects.tsx",{urlKey:i,redirectsAvailable:!!t}))},[o,e,t,r,n]),isLoading:o,isError:l,redirectUrls:t}},le=()=>{const{setItem:e}=V();return p.useCallback((t,o)=>y(t,o).then(()=>{e(t)}),[e])},ue=e=>e===H.permitHolder?h.parkingPermitHolder:h.parkingVisitor,me=()=>{const e=le();return p.useCallback(async(t,o)=>{const l=ue(o);let r=[];try{const n=await W(l);if(n){let c;try{c=JSON.parse(n)}catch{c=[]}Array.isArray(c)&&(r=c.filter(i=>typeof i=="object"&&i!==null&&"reportCode"in i&&"pin"in i))}}catch{r=[]}r=r.filter(n=>n.reportCode!==t.reportCode),r.push(t),await e(l,JSON.stringify(r))},[e])},ge=e=>{if(!e)return;const t="data"in e&&e.data&&typeof e.data=="object"&&"code"in e.data&&e.data.code;return t==="SSP_BAD_CREDENTIALS"?d.loginForbiddenFailed:t==="SSP_ACCOUNT_INACTIVE"?d.loginAccountInactiveFailed:t==="SSP_ACCOUNT_BLOCKED"?d.loginAccountBlockedFailed:d.loginFailed},de=()=>{const e=J(),t=ee({defaultValues:e}),o=p.useRef(null),{setAccessToken:l}=Q(),{resetAlert:r,setAlert:n}=G(),c=w(),{openRedirect:i}=pe(),{handleSubmit:D,setValue:f}=t,[U,{error:P,isError:S,isLoading:b}]=X(),B=me(),u=Y(),A=D(async({pin:s,reportCode:m})=>{try{const{access_token:g,access_token_expiration:q,scope:F}=await U({pin:s,report_code:m}).unwrap();await B({pin:s,reportCode:m},F),l(m,g,q),u(_.actions.setCurrentAccount(m)),u(_.actions.setCurrentPermitReportCode(void 0)),u(_.actions.setParkingAccount({reportCode:m,scope:F})),u(Z.util.resetApiState()),u($(!1))}catch(g){c(v.parkingLoginFailed,"ParkingLoginForm.tsx",{error:g}),R("ParkingLoginForm onSubmit error:",g)}});return p.useEffect(()=>{e&&(f("reportCode",e.reportCode),f("pin",e.pin))},[e,f]),p.useEffect(()=>{if(!S)return;const s=ge(P);s&&n(s)},[S,P,n]),p.useEffect(()=>{b&&r()},[b,r]),a.jsx(te,{...t,children:a.jsxs(I,{gutter:"xl",children:[a.jsxs(I,{gutter:"md",children:[a.jsx(C,{autoFocus:!0,hasClearButton:!1,keyboardType:"numbers-and-punctuation",label:"Meldcode",name:"reportCode",onSubmitEditing:()=>{var s;(s=o.current)==null||s.focus()},returnKeyType:K.OS==="android"?"done":void 0,rules:{required:"Vul een meldcode in"},submitBehavior:"submit",testID:"ParkingLoginFormReportCodeInputField",textTransform:s=>s.replaceAll(/[^a-zA-Z0-9]/g,"").toUpperCase()}),a.jsx(C,{fieldType:ne.pin,hasClearButton:!1,label:"Pincode",name:"pin",onSubmitEditing:A,ref:o,rules:{required:"Vul een pincode in"},testID:"ParkingLoginFormPinCodeInputField"}),a.jsxs(se,{children:["Meld- of pincode kwijt? U vindt ze in"," ",a.jsx(oe,{isExternal:!0,"logging-label":"ParkingLoginFormInlineLink",onPress:()=>i(j.my_parking),testID:"ParkingLoginFormInlineLink",children:"Mijn Parkeren"})]})]}),a.jsx(re,{isLoading:t.formState.isSubmitting,label:"Inloggen",onPress:A,testID:"ParkingLoginFormSubmitButton"})]})})},Ke={component:de},k={};var x,L,E;k.parameters={...k.parameters,docs:{...(x=k.parameters)==null?void 0:x.docs,source:{originalSource:"{}",...(E=(L=k.parameters)==null?void 0:L.docs)==null?void 0:E.source}}};const et=["Default"];export{k as Default,et as __namedExportsOrder,Ke as default};
