import{c as N,aQ as M,N as O,r as p,E as v,a4 as z,aR as V,aS as y,aT as F,aU as W,aB as G,aP as d,aV as H,aW as J,aN as Q,aX as Z,a as X,aY as _,aG as Y,aZ as $,f as R,j as a,P as K}from"./iframe-DtO9NZSq.js";import{u as ee,F as te}from"./index.esm-b7m0uYIr.js";import{B as re}from"./Button-CnfSLUBp.js";import{T as C,F as ne}from"./TextInputField-C9AaQZ-Q.js";import{C as I}from"./Column-B4jMnh3O.js";import{u as ie,I as oe}from"./useOpenWebUrl-aVdDvvF-.js";import{P as se}from"./Paragraph-pn8btVph.js";import{u as w}from"./useTrackException-eri-g5QH.js";import"./preload-helper-Dp1pzeXC.js";import"./PressableBase-B6Ez4y4O.js";import"./usePiwikTrackCustomEventFromProps-C2xJgdST.js";import"./config-BZnShabN.js";import"./Row-DC_VRXAg.js";import"./mapCrossAxisAlignment-DpnuLLqj.js";import"./mapMainAxisAlignment-BOa0GzUh.js";import"./useThemable-CcvZzX9t.js";import"./Icon-KsuuyL2M.js";import"./index-z1i-dvpy.js";import"./types-CVDZqz9V.js";import"./useDeviceContext-BlYsZ-IW.js";import"./AccessibleText-DMXNTf8I.js";import"./CharactersLeftDisplay-D7ih3YRF.js";import"./ErrorMessage-DTNXJRrI.js";import"./TextInput-zmhgbKS8.js";import"./index-rW2Uxnh3.js";import"./index-BmZN0z-q.js";import"./gestureObjects-BUh-a-hL.js";import"./IconButton-CrKO4OpE.js";import"./Pressable-CD9gpmpv.js";import"./Box-DFrmg2Wb.js";import"./layoutStyles-DhrVh2Xl.js";import"./Badge-CzOKcEa_.js";import"./formatNumber-BOnMa6yj.js";import"./Label-CYZn7aIF.js";import"./Phrase-GVKPSfax.js";import"./useAccessibilityAnnounce-MYb3WXr8.js";import"./useIsScreenReaderEnabled-DK3qZ5aG.js";import"./duration-BuVGVTSA.js";var T=(e=>(e.getRedirectUrls="getRedirectUrls",e))(T||{}),j=(e=>(e.acknowledgeChild="acknowledgeChild",e.birth="birth",e.chatPrivacy="chatPrivacy",e.cityPassChildBudget="cityPassChildBudget",e.cityPassLowIncomeSupport="cityPassLowIncomeSupport",e.cityPassRequest="cityPassRequest",e.cityPassUsage="cityPassUsage",e.citypass="citypass",e.contactForm="contactForm",e.contactNewsletterSignup="contactNewsletterSignup",e.documents="documents",e.elections="elections",e.feedbackForm="feedbackForm",e.immigration="immigration",e.income_help="income_help",e.lifelessBirth="lifelessBirth",e.makeAppointMentWeesp="makeAppointMentWeesp",e.marriage="marriage",e.marriagePermission="marriagePermission",e.my_parking="my_parking",e.naturalisation="naturalisation",e.parking="parking",e.parking_request_license_plate_ga_bewoners="parking_request_license_plate_ga_bewoners",e.parking_request_license_plate_ga_bezoekers="parking_request_license_plate_ga_bezoekers",e.parking_request_license_plate_mantelzorgers="parking_request_license_plate_mantelzorgers",e.passing="passing",e.passingForFuneralDirectors="passingForFuneralDirectors",e.relocation="relocation",e.rivm_report="rivm_report",e.sailingAndMooring="sailingAndMooring",e.waste="waste",e))(j||{});const ae=N.injectEndpoints({endpoints:e=>({[T.getRedirectUrls]:e.query({query:()=>({slug:O.contact,url:"/links"}),keepUnusedDataFor:M.hour})}),overrideExisting:!0}),{useGetRedirectUrlsQuery:ce}=ae,pe=()=>{const e=ie(),{data:t,isLoading:o,isError:l,refetch:r}=ce(),n=w();return{openRedirect:p.useCallback(i=>{!t&&!o&&r(),i&&(t!=null&&t[i])?e(t[i]):(z.alert(`Sorry, deze functie is ${t?"":"even "}niet beschikbaar.`,t?"":"Probeer het later opnieuw."),t&&n(v.redirectNotFound,"Redirects.tsx",{urlKey:i,redirectsAvailable:!!t}))},[o,e,t,r,n]),isLoading:o,isError:l,redirectUrls:t}},le=()=>{const{setItem:e}=V();return p.useCallback((t,o)=>y(t,o).then(()=>{e(t)}),[e])},ue=e=>e===G.permitHolder?F.parkingPermitHolder:F.parkingVisitor,me=()=>{const e=le();return p.useCallback(async(t,o)=>{const l=ue(o);let r=[];try{const n=await W(l);if(n){let c;try{c=JSON.parse(n)}catch{c=[]}Array.isArray(c)&&(r=c.filter(i=>typeof i=="object"&&i!==null&&"reportCode"in i&&"pin"in i))}}catch{r=[]}r=r.filter(n=>n.reportCode!==t.reportCode),r.push(t),await e(l,JSON.stringify(r))},[e])},ge=e=>{if(!e)return;const t="data"in e&&e.data&&typeof e.data=="object"&&"code"in e.data&&e.data.code;return t==="SSP_BAD_CREDENTIALS"?d.loginForbiddenFailed:t==="SSP_ACCOUNT_INACTIVE"?d.loginAccountInactiveFailed:t==="SSP_ACCOUNT_BLOCKED"?d.loginAccountBlockedFailed:d.loginFailed},de=()=>{const e=H(),t=ee({defaultValues:e}),o=p.useRef(null),{setAccessToken:l}=J(),{resetAlert:r,setAlert:n}=Q(),c=w(),{openRedirect:i}=pe(),{handleSubmit:B,setValue:f}=t,[D,{error:P,isError:S,isLoading:b}]=Z(),U=me(),u=X(),A=B(async({pin:s,reportCode:m})=>{try{const{access_token:g,access_token_expiration:q,scope:h}=await D({pin:s,report_code:m}).unwrap();await U({pin:s,reportCode:m},h),l(m,g,q),u(_.actions.setCurrentAccount(m)),u(_.actions.setCurrentPermitReportCode(void 0)),u(_.actions.setParkingAccount({reportCode:m,scope:h})),u(Y.util.resetApiState()),u($(!1))}catch(g){c(v.parkingLoginFailed,"ParkingLoginForm.tsx",{error:g}),R("ParkingLoginForm onSubmit error:",g)}});return p.useEffect(()=>{e&&(f("reportCode",e.reportCode),f("pin",e.pin))},[e,f]),p.useEffect(()=>{if(!S)return;const s=ge(P);s&&n(s)},[S,P,n]),p.useEffect(()=>{b&&r()},[b,r]),a.jsx(te,{...t,children:a.jsxs(I,{gutter:"xl",children:[a.jsxs(I,{gutter:"md",children:[a.jsx(C,{autoFocus:!0,hasClearButton:!1,keyboardType:"numbers-and-punctuation",label:"Meldcode",name:"reportCode",onSubmitEditing:()=>{var s;(s=o.current)==null||s.focus()},returnKeyType:K.OS==="android"?"done":void 0,rules:{required:"Vul een meldcode in"},submitBehavior:"submit",testID:"ParkingLoginFormReportCodeInputField",textTransform:s=>s.replaceAll(/[^a-zA-Z0-9]/g,"").toUpperCase()}),a.jsx(C,{fieldType:ne.pin,hasClearButton:!1,label:"Pincode",name:"pin",onSubmitEditing:A,ref:o,rules:{required:"Vul een pincode in"},testID:"ParkingLoginFormPinCodeInputField"}),a.jsxs(se,{children:["Meld- of pincode kwijt? U vindt ze in"," ",a.jsx(oe,{isExternal:!0,"logging-label":"ParkingLoginFormInlineLink",onPress:()=>i(j.my_parking),testID:"ParkingLoginFormInlineLink",children:"Mijn Parkeren"})]})]}),a.jsx(re,{isLoading:t.formState.isSubmitting,label:"Inloggen",onPress:A,testID:"ParkingLoginFormSubmitButton"})]})})},Ke={component:de},k={};var x,L,E;k.parameters={...k.parameters,docs:{...(x=k.parameters)==null?void 0:x.docs,source:{originalSource:"{}",...(E=(L=k.parameters)==null?void 0:L.docs)==null?void 0:E.source}}};const et=["Default"];export{k as Default,et as __namedExportsOrder,Ke as default};
